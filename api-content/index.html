{"posts":[{"title":"HiveSQL_练习","content":"1.有emp_sex表数据如下 name dept_id sex 悟空 A 男 大海 A 男 宋宋 B 男 凤姐 A 女 婷姐 B 女 婷婷 B 女 问题：写出每个部门男女各有多少人的sql？ 结果示例 man woman A 2 1 B 1 2 2.有person_info表数据如下： name constellation blood_type 孙悟空 白羊座 A 大海 射手座 A 宋宋 白羊座 B 猪八戒 白羊座 A 凤姐 射手座 A 需求：把血型和星座一样的人归类到一起 结果示例： 射手座,A 大海|凤姐 白羊座,A 孙悟空|猪八戒 白羊座,B 宋宋 3.窗口函数练习：有一段数据文件如下 name,orderdate,cost jack,2017-01-01,10 tony,2017-01-02,15 jack,2017-02-03,23 tony,2017-01-04,29 jack,2017-01-05,46 jack,2017-04-06,42 tony,2017-01-07,50 jack,2017-01-08,55 mart,2017-04-08,62 mart,2017-04-09,68 neil,2017-05-10,12 mart,2017-04-11,75 neil,2017-06-12,80 mart,2017-04-13,94 create table business( name string, orderdate string, cost int ) ROW FORMAT DELIMITED FIELDS TERMINATED BY ','; 需求1：查询在2017年4月份购买过产品的顾客姓名及购买次数 需求2：查询顾客的购买明细及每个月所有顾客的购买总额 需求3：上述的场景，将每个顾客的cost按照日期进行累加 需求4：查看顾客上次购买的时间 需求5：查询前20%时间的订单信息 4.函数练习：有score表数据如下 name subject score 孙悟空 语文 87 孙悟空 数学 95 孙悟空 英语 68 大海 语文 94 大海 数学 56 大海 英语 84 宋宋 语文 64 宋宋 数学 86 宋宋 英语 84 婷婷 语文 65 婷婷 数学 85 婷婷 英语 78 需求：按照每门学科进行排名 ","link":"https://leezhiwl.github.io/post/hivesql_/"},{"title":"Hive_基础知识问题","content":"1.关闭防火墙应该如何操作? systemctl stop firewalld.service Systemctl disable firewalld.service 2.修改IP时，需要更改哪个文件？ Vim /etc/sysconfig/network-scripts/ifcfg-ens33 BOOTPROTO='static' 3.Hive中的复杂数据类型有哪些？ STRUCT: 通过“点”符号访问元素类容 MAP: 是一组键-值对元祖集合，使用数组表示法可以访问数据 ARRAY: 是一组具有相同类型和名称的变量的集合。这些变量称为数组的元素，每个数组元素都有一个编号，编号从零开始。 4.Hive中查看数据库基本信息的指令？ Desc database extended 数据库名; 5.尝试写出Hive中创建表的完整语法？ Create [external] table if not exists 表名 (列名 数据类型 [comment 本列注释],...) [comment 表注释] [partitioned by (列名 数据类型 [comment 本列注释],...)] [clustered by (列名,列名,...)] [sorted by (列名 [asc|desc],...)] info num_buckets buckets] [row format row_format] [stored as file_format] [location hdfs_path] [tblproperties (property_name=property_value,...)] [as select_statement] 6.内部表和外部表的区别？ Hive在创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径，不对数据的位置坐任何改变。 目前所创建的表都是所谓的管理表，有时也被称为内部表，因为这种表，Hive会(或多或少地)控制着数据的生命周期。 当删除一个管理表时，Hive也会删除这个表中的数据，管理表不方便和其他工作共享数据。 用关键字external说明 指定外部表存放的数据的路径 如果不指定外部表的存放路径，Hive将在HDFS上的/user/hive/warehouse文件夹下以外部表名创建一个文件夹， 并且将属于这个表的数据都存放在这里 当删除一个外部表时，只会删除表的元数据信息，而不会删除数据 在生产中一般创建外部表来存储数据 7.如何清除Hive表中的数据？ Truncate table 表名; 8.静态分区表和动态分区表有什么区别？ 静态分区与动态分区的主要区别在于静态分区是手动指定，而动态分区是通过数据来进行判断。 静态分区的列是在编译时期，通过用户传递列名来决定的；动态分区是在SQL执行的时候确定的。 9.Hive的严格模式限制了哪几种查询？ 分区查询，选择数据条数限制 10.如何将HDFS中的数据导入到Hive表中？ load data inpath 'HDFS上的路径' into table 表名 [partition(partcoll=vall,....)]; ","link":"https://leezhiwl.github.io/post/hive_-lian-xi/"}]}